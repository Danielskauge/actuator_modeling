[34m[1mwandb[0m: logging graph, to disable use `wandb.watch(log_graph=False)`
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Starting training for fold 1...
You are using a CUDA device ('NVIDIA GeForce RTX 3090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
Warning: Total training steps (inf) <= warmup steps (inf). Cosine decay might not behave as expected. Effective LR may be constant or only warmup.

  | Name          | Type       | Params | Mode
-----------------------------------------------------
0 | model         | GRUModel   | 150 K  | train
1 | train_metrics | ModuleDict | 0      | train
2 | val_metrics   | ModuleDict | 0      | train
3 | test_metrics  | ModuleDict | 0      | train
-----------------------------------------------------
150 K     Trainable params
0         Non-trainable params
150 K     Total params
0.601     Total estimated model params size (MB)
18        Modules in train mode
0         Modules in eval mode
Epoch 87: 100%|█| 125/125 [00:01<00:00, 71.82it/s, v_num=mf3e, train_loss_step=0.00438, val_loss=0.00471, val_mse_epoch=0.00398, val_rmse_epoch=0.0631, val_mae_epoch=0.0503, val_r2_epoch=0.416, train_loss_epoch=0.00427, train_mse_epoch=
Starting testing for fold 1...                                                                                                                                                                                                              
Metric val_rmse_epoch improved. New best score: 0.123
/home/daniel/miniconda3/lib/python3.12/site-packages/pytorch_lightning/callbacks/lr_monitor.py:217: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
Metric val_rmse_epoch improved by 0.002 >= min_delta = 0.0001. New best score: 0.121
Metric val_rmse_epoch improved by 0.022 >= min_delta = 0.0001. New best score: 0.099
Metric val_rmse_epoch improved by 0.005 >= min_delta = 0.0001. New best score: 0.094
Metric val_rmse_epoch improved by 0.002 >= min_delta = 0.0001. New best score: 0.092
Metric val_rmse_epoch improved by 0.001 >= min_delta = 0.0001. New best score: 0.090
Metric val_rmse_epoch improved by 0.001 >= min_delta = 0.0001. New best score: 0.089
Metric val_rmse_epoch improved by 0.001 >= min_delta = 0.0001. New best score: 0.088
Metric val_rmse_epoch improved by 0.002 >= min_delta = 0.0001. New best score: 0.086
Metric val_rmse_epoch improved by 0.011 >= min_delta = 0.0001. New best score: 0.076
Metric val_rmse_epoch improved by 0.006 >= min_delta = 0.0001. New best score: 0.069
Metric val_rmse_epoch improved by 0.004 >= min_delta = 0.0001. New best score: 0.066
Metric val_rmse_epoch improved by 0.003 >= min_delta = 0.0001. New best score: 0.063
Metric val_rmse_epoch improved by 0.002 >= min_delta = 0.0001. New best score: 0.061
Metric val_rmse_epoch improved by 0.000 >= min_delta = 0.0001. New best score: 0.061
Monitored metric val_rmse_epoch did not improve in the last 20 records. Best score: 0.061. Signaling Trainer to stop.
Restoring states from the checkpoint path at /home/daniel/workspace/actuator_modeling/outputs/2025-05-28/15-02-32/checkpoints/fold_1/gru-fold_1_debug-epoch=67-val_rmse_epoch=0.0606.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
Loaded model weights from the checkpoint at /home/daniel/workspace/actuator_modeling/outputs/2025-05-28/15-02-32/checkpoints/fold_1/gru-fold_1_debug-epoch=67-val_rmse_epoch=0.0606.ckpt
Testing DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:00<00:00, 263.39it/s]
Generating test set prediction plots...
Logging plots to WandB...
Plots logged.
Testing DataLoader 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 63/63 [00:00<00:00, 67.97it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1m       Test metric       [0m[1m [0m┃[1m [0m[1m      DataLoader 0       [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m [0m[36m        test_loss        [0m[36m [0m│[35m [0m[35m  0.004423895850777626   [0m[35m [0m│
│[36m [0m[36m     test_mae_epoch      [0m[36m [0m│[35m [0m[35m   0.04818049445748329   [0m[35m [0m│
│[36m [0m[36m     test_mse_epoch      [0m[36m [0m│[35m [0m[35m  0.003667660988867283   [0m[35m [0m│
│[36m [0m[36m      test_r2_epoch      [0m[36m [0m│[35m [0m[35m   0.46199119091033936   [0m[35m [0m│
│[36m [0m[36m     test_rmse_epoch     [0m[36m [0m│[35m [0m[35m   0.06056121736764908   [0m[35m [0m│
└───────────────────────────┴───────────────────────────┘
Fold 1 Test Metrics: {'test_loss': 0.004423895850777626, 'test_mse_epoch': 0.003667660988867283, 'test_rmse_epoch': 0.06056121736764908, 'test_mae_epoch': 0.04818049445748329, 'test_r2_epoch': 0.46199119091033936}
